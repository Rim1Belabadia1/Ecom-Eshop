{"ast":null,"code":"import Login from\"../Components/Login\";import{json,redirect}from\"react-router-dom\";import{jsx as _jsx}from\"react/jsx-runtime\";function LoginPage(){return/*#__PURE__*/_jsx(Login,{method:\"post\"});}export default LoginPage;export async function action(_ref){let{request}=_ref;const data=await request.formData();const authdata={username:data.get('username'),password:data.get('password')};const url=process.env.REACT_APP_BASEURL+\"token\";const response=await fetch(url,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(authdata)});if(response.status===422||response.status===401){return response;}if(!response.ok){return json({message:'Not a valid User'},{status:500});}const resData=await response.json();const token=resData.token;console.log(\"resData.userInfo: \"+resData.user.role);localStorage.setItem('token',token);localStorage.setItem('userRole',resData.user.role);localStorage.setItem('userId',resData.user.id);localStorage.setItem('userData',JSON.stringify(resData.user));return redirect('/');}","map":{"version":3,"names":["Login","json","redirect","jsx","_jsx","LoginPage","method","action","_ref","request","data","formData","authdata","username","get","password","url","process","env","REACT_APP_BASEURL","response","fetch","headers","body","JSON","stringify","status","ok","message","resData","token","console","log","user","role","localStorage","setItem","id"],"sources":["C:/Users/User/Desktop/eCom in SB and ReactJS/Frontend/ecom/src/Pages/LoginPage.js"],"sourcesContent":["import Login from \"../Components/Login\";\r\nimport { json, redirect } from \"react-router-dom\";\r\nfunction LoginPage(){\r\n    return(\r\n      <Login method=\"post\"/>\r\n    )\r\n}\r\n\r\nexport default LoginPage;\r\n\r\nexport async function action({ request }) {\r\n\r\n \r\n  const data = await request.formData();\r\n  const authdata ={\r\n    username : data.get('username'),\r\n    password : data.get('password')\r\n  }\r\n\r\n  const url= process.env.REACT_APP_BASEURL+\"token\";\r\n  const response = await fetch(url, {\r\n    method: 'POST',\r\n    headers: {\r\n      'Content-Type': 'application/json'\r\n    },\r\n    body: JSON.stringify(authdata)\r\n  })\r\n\r\n  if(response.status === 422 || response.status === 401){\r\n      return response;\r\n    }\r\n\r\n    if(!response.ok){\r\n      return json({message: 'Not a valid User'}, {status: 500})\r\n    }\r\n\r\n    const resData = await response.json();\r\n    const token = resData.token;\r\n    console.log(\"resData.userInfo: \"+resData.user.role)\r\n    localStorage.setItem('token', token);\r\n    localStorage.setItem('userRole', resData.user.role)\r\n   localStorage.setItem('userId', resData.user.id)\r\n    localStorage.setItem('userData', JSON.stringify(resData.user) )\r\n   return  redirect('/')\r\n}"],"mappings":"AAAA,MAAO,CAAAA,KAAK,KAAM,qBAAqB,CACvC,OAASC,IAAI,CAAEC,QAAQ,KAAQ,kBAAkB,CAAC,OAAAC,GAAA,IAAAC,IAAA,yBAClD,QAAS,CAAAC,SAASA,CAAA,CAAE,CAChB,mBACED,IAAA,CAACJ,KAAK,EAACM,MAAM,CAAC,MAAM,CAAC,CAAC,CAE5B,CAEA,cAAe,CAAAD,SAAS,CAExB,MAAO,eAAe,CAAAE,MAAMA,CAAAC,IAAA,CAAc,IAAb,CAAEC,OAAQ,CAAC,CAAAD,IAAA,CAGtC,KAAM,CAAAE,IAAI,CAAG,KAAM,CAAAD,OAAO,CAACE,QAAQ,CAAC,CAAC,CACrC,KAAM,CAAAC,QAAQ,CAAE,CACdC,QAAQ,CAAGH,IAAI,CAACI,GAAG,CAAC,UAAU,CAAC,CAC/BC,QAAQ,CAAGL,IAAI,CAACI,GAAG,CAAC,UAAU,CAChC,CAAC,CAED,KAAM,CAAAE,GAAG,CAAEC,OAAO,CAACC,GAAG,CAACC,iBAAiB,CAAC,OAAO,CAChD,KAAM,CAAAC,QAAQ,CAAG,KAAM,CAAAC,KAAK,CAACL,GAAG,CAAE,CAChCV,MAAM,CAAE,MAAM,CACdgB,OAAO,CAAE,CACP,cAAc,CAAE,kBAClB,CAAC,CACDC,IAAI,CAAEC,IAAI,CAACC,SAAS,CAACb,QAAQ,CAC/B,CAAC,CAAC,CAEF,GAAGQ,QAAQ,CAACM,MAAM,GAAK,GAAG,EAAIN,QAAQ,CAACM,MAAM,GAAK,GAAG,CAAC,CAClD,MAAO,CAAAN,QAAQ,CACjB,CAEA,GAAG,CAACA,QAAQ,CAACO,EAAE,CAAC,CACd,MAAO,CAAA1B,IAAI,CAAC,CAAC2B,OAAO,CAAE,kBAAkB,CAAC,CAAE,CAACF,MAAM,CAAE,GAAG,CAAC,CAAC,CAC3D,CAEA,KAAM,CAAAG,OAAO,CAAG,KAAM,CAAAT,QAAQ,CAACnB,IAAI,CAAC,CAAC,CACrC,KAAM,CAAA6B,KAAK,CAAGD,OAAO,CAACC,KAAK,CAC3BC,OAAO,CAACC,GAAG,CAAC,oBAAoB,CAACH,OAAO,CAACI,IAAI,CAACC,IAAI,CAAC,CACnDC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAEN,KAAK,CAAC,CACpCK,YAAY,CAACC,OAAO,CAAC,UAAU,CAAEP,OAAO,CAACI,IAAI,CAACC,IAAI,CAAC,CACpDC,YAAY,CAACC,OAAO,CAAC,QAAQ,CAAEP,OAAO,CAACI,IAAI,CAACI,EAAE,CAAC,CAC9CF,YAAY,CAACC,OAAO,CAAC,UAAU,CAAEZ,IAAI,CAACC,SAAS,CAACI,OAAO,CAACI,IAAI,CAAE,CAAC,CAChE,MAAQ,CAAA/B,QAAQ,CAAC,GAAG,CAAC,CACxB"},"metadata":{},"sourceType":"module","externalDependencies":[]}