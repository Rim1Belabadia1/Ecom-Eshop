{"ast":null,"code":"import{Form}from'react-router-dom';import{json,redirect}from'react-router-dom';import{getAuthToken}from\"../util/auth\";import{useActionData}from'react-router-dom';import{useState}from\"react\";import cat from\"../Image/cat.png\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";let imageFile=null;function Categories(_ref){let{method,category}=_ref;const token=getAuthToken();const errData=useActionData();const[image,setImage]=useState(false);const handleImageUpload=event=>{imageFile=event.target.files[0];setImage(true);};return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"section\",{className:\"vh-100\",style:{backgroundColor:'#eee'},children:/*#__PURE__*/_jsx(\"div\",{className:\"container h-100\",children:/*#__PURE__*/_jsx(\"div\",{className:\"row d-flex justify-content-center align-items-center h-100\",children:/*#__PURE__*/_jsx(\"div\",{className:\"col-lg-12 col-xl-11\",children:/*#__PURE__*/_jsx(\"div\",{className:\"card text-black\",style:{borderRadius:'25px;'},children:/*#__PURE__*/_jsx(\"div\",{className:\"card-body p-md-5\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"row justify-content-center\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-10 col-lg-6 col-xl-5 order-2 order-lg-1\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-center h1 fw-bold mb-5 mx-1 mx-md-4 mt-4\",style:{textDecoration:'underline'},children:\"Add Category\"}),/*#__PURE__*/_jsxs(Form,{classNameName:\"mx-1 mx-md-4\",method:method,encType:\"multipart/form-data\",children:[errData&&errData.errors&&/*#__PURE__*/_jsx(\"ul\",{children:Object.values(errData.errors).map(err=>/*#__PURE__*/_jsx(\"li\",{children:err},err))}),errData&&errData.message&&/*#__PURE__*/_jsx(\"p\",{class:\"text-danger\",children:errData.message}),/*#__PURE__*/_jsx(\"input\",{id:\"id\",type:\"hidden\",name:\"id\",required:true,defaultValue:category?category.id:''}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex flex-row align-items-center mb-4\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-user fa-lg me-3 fa-fw\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-outline flex-fill mb-0\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"name\",id:\"form3Example1c\",className:\"form-control\",required:true,defaultValue:category?category.name:''}),/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",for:\"form3Example1c\",children:\"Category Name\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex flex-row align-items-center mb-4\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-user fa-lg me-3 fa-fw\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-outline flex-fill mb-0\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"file\",name:\"image\",accept:\"image/*\",id:\"form3Example1c\",className:\"form-control\",required:method!==\"PATCH\",onChange:handleImageUpload}),/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",for:\"form3Example1c\",children:\"Image\"}),method===\"PATCH\"&&category.image&&!image&&/*#__PURE__*/_jsx(\"img\",{class:\"d-block img-fluid\",src:\"data:image/png;base64,\".concat(category.image),alt:\"\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"d-flex justify-content-center mx-4 mb-3 mb-lg-4\",children:/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn btn-primary btn-lg\",children:token?'Save':'Save'})})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"col-md-10 col-lg-6 col-xl-7 d-flex align-items-center order-1 order-lg-2\",children:/*#__PURE__*/_jsx(\"img\",{src:cat,className:\"img-fluid\",alt:\"Sample image\"})})]})})})})})})})});}export default Categories;export async function action(_ref2){let{request}=_ref2;const method=request.method;const fromData=await request.formData();const token=getAuthToken();let catData={name:fromData.get(\"name\"),image:\"\"};console.log(\"JSON.stringify(eventData): \"+JSON.stringify(catData));let url=process.env.REACT_APP_BASEURL+'addCategory';console.log(\"method: \"+method);console.log(\"URK: \"+url);if(method===\"PATCH\"){url=process.env.REACT_APP_BASEURL+\"updateCategory\";catData={id:fromData.get(\"id\"),name:fromData.get(\"name\"),image:\"\"};}const data=new FormData();data.append(\"categoryData\",JSON.stringify(catData));data.append(\"image\",imageFile);console.log(\"Final cat_Data: \"+JSON.stringify(data));var config={};if(token){config={'Authorization':'Bearer '+token};}else{config={'Content-Type':'application/json'};}const response=await fetch(url,{method:method,headers:config,body:data});if(!response.ok){throw json({message:'Could not create User'},{status:500});}else{if(token){alert(\"Category Created Successfully\");return redirect('/categories');}else{alert(\"Category Created Successfully\");return redirect('/categories');}}}","map":{"version":3,"names":["Form","json","redirect","getAuthToken","useActionData","useState","cat","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","imageFile","Categories","_ref","method","category","token","errData","image","setImage","handleImageUpload","event","target","files","children","className","style","backgroundColor","borderRadius","textDecoration","classNameName","encType","errors","Object","values","map","err","message","class","id","type","name","required","defaultValue","for","accept","onChange","src","concat","alt","action","_ref2","request","fromData","formData","catData","get","console","log","JSON","stringify","url","process","env","REACT_APP_BASEURL","data","FormData","append","config","response","fetch","headers","body","ok","status","alert"],"sources":["C:/Users/User/Desktop/eCom in SB and ReactJS/Frontend/ecom/src/Components/Categories.js"],"sourcesContent":["import { Form } from 'react-router-dom';\r\nimport { json, redirect } from 'react-router-dom'\r\nimport { getAuthToken } from \"../util/auth\";\r\nimport { useActionData } from 'react-router-dom';\r\nimport { useState } from \"react\";\r\nimport cat from \"../Image/cat.png\";\r\n\r\nlet imageFile=null;\r\nfunction Categories({ method, category }) {\r\n  const token = getAuthToken();\r\n  const errData = useActionData();\r\n  const [image, setImage] = useState(false);\r\n\r\n  const handleImageUpload = (event) => {\r\n     imageFile = event.target.files[0];\r\n     setImage(true);\r\n  };\r\n  return <>\r\n    <section className=\"vh-100\" style={{ backgroundColor: '#eee' }}>\r\n      <div className=\"container h-100\">\r\n        <div className=\"row d-flex justify-content-center align-items-center h-100\">\r\n          <div className=\"col-lg-12 col-xl-11\">\r\n            <div className=\"card text-black\" style={{ borderRadius: '25px;' }}>\r\n              <div className=\"card-body p-md-5\">\r\n                <div className=\"row justify-content-center\">\r\n                  <div className=\"col-md-10 col-lg-6 col-xl-5 order-2 order-lg-1\">\r\n\r\n                    <p className=\"text-center h1 fw-bold mb-5 mx-1 mx-md-4 mt-4\" style={{ textDecoration: 'underline'}}>Add Category</p>\r\n\r\n                    <Form classNameName=\"mx-1 mx-md-4\" method={method} encType=\"multipart/form-data\">\r\n\r\n                      {errData && errData.errors && <ul>\r\n                        {Object.values(errData.errors).map((err) => (\r\n                          <li key={err}>{err}</li>\r\n                        ))}\r\n                      </ul>}\r\n                      {errData && errData.message && <p class=\"text-danger\">{errData.message}</p>}\r\n                      \r\n                      <input id=\"id\" type=\"hidden\" name=\"id\" required defaultValue={category ? category.id : ''} />\r\n                   \r\n\r\n                      <div className=\"d-flex flex-row align-items-center mb-4\">\r\n                        <i className=\"fas fa-user fa-lg me-3 fa-fw\"></i>\r\n                        <div className=\"form-outline flex-fill mb-0\">\r\n                          <input type=\"text\" name=\"name\" id=\"form3Example1c\" className=\"form-control\" required defaultValue={category ? category.name : ''} />\r\n                          <label className=\"form-label\" for=\"form3Example1c\">Category Name</label>\r\n                        </div>\r\n                      </div>\r\n\r\n                      <div className=\"d-flex flex-row align-items-center mb-4\">\r\n                          <i className=\"fas fa-user fa-lg me-3 fa-fw\"></i>\r\n                          <div className=\"form-outline flex-fill mb-0\">\r\n                            <input\r\n                              type=\"file\"\r\n                              name=\"image\"\r\n                              accept=\"image/*\"\r\n                              id=\"form3Example1c\"\r\n                              className=\"form-control\"\r\n                              required={method!==\"PATCH\"}\r\n                              onChange={handleImageUpload}\r\n                            />\r\n                            <label className=\"form-label\" for=\"form3Example1c\">\r\n                              Image\r\n                            </label>\r\n                              {method===\"PATCH\" && category.image && !image &&<img class=\"d-block img-fluid\" src={`data:image/png;base64,${category.image}`} alt=\"\"/> }\r\n                          </div>\r\n                          </div>\r\n                 \r\n\r\n                      <div className=\"d-flex justify-content-center mx-4 mb-3 mb-lg-4\">\r\n                        <button type=\"submit\" className=\"btn btn-primary btn-lg\">{token ? 'Save' : 'Save'}</button>\r\n                      </div>\r\n\r\n                    </Form>\r\n\r\n                  </div>\r\n                  <div className=\"col-md-10 col-lg-6 col-xl-7 d-flex align-items-center order-1 order-lg-2\">\r\n\r\n                    <img src={cat}\r\n                      className=\"img-fluid\" alt=\"Sample image\" />\r\n\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </section>\r\n  </>\r\n}\r\n\r\nexport default Categories;\r\n\r\n\r\nexport async function action({ request }) {\r\n  const method = request.method;\r\n  const fromData = await request.formData();\r\n  const token = getAuthToken();\r\n\r\n  let catData = {\r\n    name: fromData.get(\"name\"),\r\n    image: \"\",\r\n  }\r\n  console.log(\"JSON.stringify(eventData): \" + JSON.stringify(catData));\r\n  \r\n\r\n  let url = process.env.REACT_APP_BASEURL + 'addCategory'\r\n\r\n  console.log(\"method: \" + method)\r\n  console.log(\"URK: \" + url)\r\n\r\n  if (method === \"PATCH\") {\r\n    url = process.env.REACT_APP_BASEURL + \"updateCategory\";\r\n    catData = {\r\n      id: fromData.get(\"id\"),\r\n      name: fromData.get(\"name\"),\r\n      image: \"\",\r\n\r\n    }\r\n  }\r\n\r\n  const data = new FormData();\r\n  data.append(\"categoryData\", JSON.stringify(catData));\r\n  data.append(\"image\", imageFile);\r\n\r\n  console.log(\"Final cat_Data: \" +JSON.stringify(data) )\r\n\r\n  var config = {};\r\n\r\n  if (token) {\r\n    config = {\r\n      'Authorization': 'Bearer ' + token,\r\n    };\r\n  } else {\r\n    config = {\r\n      'Content-Type': 'application/json'\r\n    };\r\n  }\r\n  const response = await fetch(url, {\r\n    method: method,\r\n    headers: config,\r\n    body: data\r\n  });\r\n\r\n  if (!response.ok) {\r\n    throw json({ message: 'Could not create User' }, { status: 500 });\r\n  } else {\r\n    if (token) {\r\n        alert(\"Category Created Successfully\");\r\n        return redirect('/categories');\r\n    } else {\r\n      alert(\"Category Created Successfully\");\r\n      return redirect('/categories');\r\n    }\r\n\r\n  }\r\n\r\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}